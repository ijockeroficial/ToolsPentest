import requests, sys
#PRINT https://i.imgur.com/0sh3RgQ.png
#Abre uma wordlist chamado: lista.txt
arquivo = open('lista.txt', 'r')
site = sys.argv[1] 

#Listas para armazenar cada tipo de HTTP Status Code
diretorio_401 = []
diretorio_403 = []
diretorio_404 = []
diretorio_407 = []
diretorio_200 = []
#Função que armazena nas listas específicas as respostas do Status code HTTP.
def armazenaRequisicao(url: str):
    req = requests.get(url)
    if req.status_code == 200:
        print(f"[OK] - Diretório encontrado: {x}")
        req.close()
        diretorio_200.append(x)

    elif req.status_code == 401:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_401.append(x)
        req.close()

    elif req.status_code == 403:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_403.append(x)
        req.close()

    elif req.status_code == 407:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_407.append(x)
        req.close()

    elif req.status_code == 404:    
        print(f"[ERRO] - Diretório [ {x} ] não encontrado!")
        diretorio_404.append(x)
        req.close()


#O x vale cada item  do arquivo. Dentro do FOR é chamada a função armazenaRequisicao()
for x in arquivo:
    x = x.rstrip('\n')
    armazenaRequisicao(site +"/"+ x)

#Função para verificar se a lista está vazia ou não.
def verificaLista(lista, codigo):
    if len(lista) > 0:
        print(lista)
        print('-' * 30)
    else:
        print(f"Nenhum código [{codigo}] foi retornado.")
        print('-' * 30)


#Apresenta para o usuário as informações obtidas.
print('-' * 30)
print("# Foram encontrados os seguintes diretórios: ")
print(f"\033[32m\033[40m[200] Success - {len(diretorio_200)} LOCAIS. \033[0;0m") 
verificaLista(diretorio_200, 200)

print(f"\033[31m\033[40m [401] Unauthorized - {len(diretorio_401)} LOCAIS \033[0;0m")
verificaLista(diretorio_401, 401)

print(f"\033[37m\033[40m [403] Forbidden - {len(diretorio_403)} LOCAIS \033[0;0m")
verificaLista(diretorio_403, 403)

print(f"\033[33m\033[40m [407] Proxy Authentication Required - {len(diretorio_407)} LOCAIS \033[0;0m")
verificaLista(diretorio_407, 407)
print(f"\033[34m\033[40m[404] Not Found - {len(diretorio_404)} LOCAIS NÃO ENCONTRADOS! \033[0;0m")
