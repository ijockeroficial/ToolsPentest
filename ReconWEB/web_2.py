import requests
from sys import argv
 
# PRINT https://i.imgur.com/0sh3RgQ.png
 
# URL do site alvo.
target = argv[1]
# Path/Caminho da wordlist.
file_path = argv[2]
 
# Listas para armazenar as url de acordo com os status code.
directory_401 = []
directory_403 = []
directory_404 = []
directory_407 = []
directory_200 = []
 
# Está função faz as requests e amarzena em uma lista as url.
def request(url: str):
    req = requests.get(url)
 
    if req.status_code == 200:
        print(f"[200] - Diretório encontrado: {url}")
        req.close()
        directory_200.append(url)
    elif req.status_code == 401:
        print(f"[401] - Diretório encontrado: {url}")
        directory_401.append(url)
        req.close()
    elif req.status_code == 403:
        print(f"[403] - Diretório encontrado: {url}")
        directory_403.append(url)
        req.close()
    elif req.status_code == 407:
        print(f"[407] - Diretório encontrado: {url}")
        directory_407.append(url)
        req.close()
    elif req.status_code == 404:
        directory_404.append(url)
        req.close()
    else:
        req.close()
 
# Está função irá verificar se a lista está vazia ou não...
# Caso ela esteja ela irá retornar uma mensagem de erro, mas caso ela não esteja vazia irá retornar a lista.
def printer_list(list_of_infos, status_code):
    print(list_of_infos.join("\n"))
    print('-' * 30)
 
if __name__ == "__main__":
    for x in open(file_path, 'r'):
       request(target +"/"+ x.rstrip('\n'))
 
    # Faz um output das informações armazenadas.
    print('-' * 30, "\n# Foram encontrados os seguintes diretórios: ")
 
    if len(directory_200) != 0:
        print(f"[200] Success - {len(directory_200)} LOCAIS")
        printer_list(directory_200, 200)
 
    if len(directory_401) != 0:
        print(f"[401] Unauthorized - {len(directory_401)} LOCAIS")
        printer_list(directory_401, 401)
 
    if len(directory_403) != 0:
        print(f"[403] Forbidden - {len(directory_403)} LOCAIS")
        printer_list(directory_403, 403)
 
    if len(directory_407) != 0:
        print(f"[407] Proxy Authentication Required - {len(directory_407)} LOCAIS")
        printer_list(directory_407, 407)
 
    if len(directory_404) != 0:
        print(f"[404] Not Found - {len(directory_404)} LOCAIS NÃO ENCONTRADOS!")