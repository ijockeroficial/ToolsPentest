import requests, sys
#Abre uma wordlist chamado: lista.txt
arquivo = open('lista.txt', 'r')
site = sys.argv[1] 

#Listas para armazenar cada tipo de HTTP Status Code
diretorio_401 = []
diretorio_403 = []
diretorio_404 = []
diretorio_407 = []
diretorio_200 = []
#Função que armazena nas listas específicas as respostas do Status code HTTP.
def armazenaRequisicao(requisicao):
    if requisicao == 200:
        print(f"[OK] - Diretório encontrado: {x}")
        req.close()
        diretorio_200.append(x)

    elif requisicao == 401:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_401.append(x)
        req.close()

    elif requisicao == 403:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_403.append(x)
        req.close()

    elif requisicao == 407:
        print(f"[OK] - Diretório encontrado: {x}")
        diretorio_407.append(x)
        req.close()

    elif requisicao == 404:    
        print(f"[ERRO] - Diretório [ {x} ] não encontrado!")
        diretorio_404.append(x)
        req.close()


#O x vale cada item  do arquivo  e chama a função armazenaRequisicao()
for x in arquivo:
    x = x.rstrip('\n')
    req = requests.get(site + x)
    resposta = req.status_code
    armazenaRequisicao(resposta)

#Função para verificar se a lista está vazia ou não.
def verificaLista(lista, codigo):
    if len(lista) > 0:
        print(lista)
        print('-' * 30)
    else:
        print(f"Nenhum código [{codigo}] foi retornado.")
        print('-' * 30)


#Apresenta para o usuário as informações obtidas.
print('-' * 30)
print("# Foram encontrados os seguintes diretórios: ")
print(f"[200] Success - {len(diretorio_200)} LOCAIS") 
verificaLista(diretorio_200, 200)

print(f"[401] Unauthorized - {len(diretorio_401)} LOCAIS")
verificaLista(diretorio_401, 401)

print(f"[403] Forbidden - {len(diretorio_403)} LOCAIS")
verificaLista(diretorio_403, 403)

print(f"[407] Proxy Authentication Required - {len(diretorio_407)} LOCAIS")
verificaLista(diretorio_407, 407)
print(f"[404] Not Found - {len(diretorio_404)} LOCAIS NÃO ENCONTRADOS!")
